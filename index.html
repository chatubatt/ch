<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Agendador Inteligente de FÃ©rias</title>
    <link rel="stylesheet" href="assets/style.css">
</head>
<body>
    <header>
        <h1 class="main-header">ğŸ“… Agendador Inteligente de FÃ©rias</h1>
        <h3>*Sistema automatizado para distribuiÃ§Ã£o inteligente de fÃ©rias por centro de custo e cargo com garantia de 100% da planilha*</h3>
    </header>

    <main>
        <section id="guide">
            <h2>ğŸ“‹ GUIA DE USO RÃPIDO</h2>
            <div class="guide-content">
                <div>
                    <h4>ğŸ“ ESTRUTURA DO ARQUIVO EXCEL:</h4>
                    <ul>
                        <li>âœ… MÃ­nimo 14 colunas (A atÃ© N)</li>
                        <li>âœ… Coluna C: Nome dos colaboradores</li>
                        <li>âœ… Coluna F: Centro de Custo (formato: 525 - Orb Atc - Sp Alexia Dayane)</li>
                        <li>âœ… Coluna G: SubcÃ©lula/Unidade</li>
                        <li>âœ… Coluna M: Data Limite (dd/mm/aaaa)</li>
                        <li>âœ… Coluna N: Cargo dos colaboradores</li>
                    </ul>
                </div>
                <div>
                    <h4>âš™ï¸ COMO USAR:</h4>
                    <ol>
                        <li>Carregue o arquivo Excel</li>
                        <li>Configure dias e percentual</li>
                        <li>Selecione centros de custo e unidades</li>
                        <li>Execute o cÃ¡lculo</li>
                        <li>Analise os resultados</li>
                        <li>Exporte o cronograma</li>
                    </ol>
                    <h4>ğŸš€ NOVO: DISTRIBUIÃ‡ÃƒO COMPLETA:</h4>
                    <ul>
                        <li>Sistema agora garante 100% da planilha</li>
                        <li>MÃºltiplas tentativas automÃ¡ticas</li>
                        <li>GrÃ¡fico Real Ã— Limite</li>
                    </ul>
                </div>
            </div>
        </section>

        <hr>

        <section id="upload-section">
            <h2>ğŸ“ PASSO 1: Arquivo</h2>
            <p class="info">ğŸ’¡ Carregue o arquivo Excel com os dados dos colaboradores</p>
            <input type="file" id="excelFile" accept=".xlsx">
            <div id="fileStatus"></div>
        </section>

        <hr>

        <section id="parameters-section">
            <h2>âš™ï¸ PASSO 2: ParÃ¢metros</h2>
            <p class="info">ğŸ’¡ Configure os parÃ¢metros de distribuiÃ§Ã£o</p>
            <div>
                <label for="diasFerias">Dias de FÃ©rias:</label>
                <input type="number" id="diasFerias" min="1" max="60" value="30">
                <p class="help">Quantidade de dias consecutivos de fÃ©rias para cada colaborador</p>
            </div>
            <div>
                <label for="percentualSimultaneo">Percentual MÃ¡ximo SimultÃ¢neo (%):</label>
                <input type="range" id="percentualSimultaneo" min="1" max="100" value="20">
                <span id="percentualValue">20%</span>
                <p class="help">Percentual mÃ¡ximo de colaboradores da mesma unidade que podem estar de fÃ©rias simultaneamente</p>
                <p class="caption" id="percentualCaption"></p>
            </div>
            <div>
                <label for="dataInicial">Data InÃ­cio da DistribuiÃ§Ã£o:</label>
                <input type="date" id="dataInicial">
                <p class="help">Data a partir da qual as fÃ©rias comeÃ§arÃ£o a ser distribuÃ­das</p>
            </div>
        </section>

        <hr>

        <section id="selection-section">
            <h2>ğŸ¯ PASSO 3: SeleÃ§Ã£o</h2>
            <p class="info">ğŸ’¡ Por padrÃ£o, TODOS os centros de custo e unidades estÃ£o selecionados para garantir 100% da planilha</p>
            
            <div>
                <label for="celulasCusto">Centros de Custo:</label>
                <select id="celulasCusto" multiple></select>
                <p class="help">Todos os centros de custo estÃ£o selecionados por padrÃ£o para processar a planilha completa</p>
                <div id="celulasCustoStats"></div>
            </div>
            <div>
                <label for="subcelulasUnidades">SubcÃ©lulas/Unidades:</label>
                <select id="subcelulasUnidades" multiple></select>
                <p class="help">Todas as unidades estÃ£o selecionadas por padrÃ£o para processar a planilha completa</p>
            </div>
        </section>

        <hr>

        <button id="processButton">ğŸš€ PROCESSAR DISTRIBUIÃ‡ÃƒO DE FÃ‰RIAS</button>

        <hr>

        <section id="analysis-section">
            <h2>ğŸ” AnÃ¡lise de Datas Limite</h2>
            <p class="info">ğŸ’¡ Analise a distribuiÃ§Ã£o das datas limite dos colaboradores para planejar melhor</p>
            <details>
                <summary>Ver AnÃ¡lise de Datas Limite</summary>
                <div>
                    <label for="analiseCelulas">Filtrar Centros de Custo para AnÃ¡lise:</label>
                    <select id="analiseCelulas" multiple></select>
                </div>
                <div>
                    <label for="analiseUnidades">Filtrar Unidades para AnÃ¡lise:</label>
                    <select id="analiseUnidades" multiple></select>
                </div>
                <div id="analysisResults"></div>
            </details>
        </section>

        <hr>

        <section id="simulation-stats">
            <h2>ğŸ“Š EstatÃ­sticas da SimulaÃ§Ã£o Completa</h2>
            <div id="statsMetrics"></div>
            <div id="successRate"></div>
        </section>

        <hr>

        <section id="visualizations">
            <h2>ğŸ“ˆ VisualizaÃ§Ãµes da DistribuiÃ§Ã£o</h2>
            <div class="tabs">
                <button class="tab-button active" data-tab="tab1">ğŸ“Š Por Unidade</button>
                <button class="tab-button" data-tab="tab2">ğŸ‘” Por Cargo</button>
                <button class="tab-button" data-tab="tab3">ğŸ“ˆ Real Ã— Limite</button>
            </div>
            <div id="tab1" class="tab-content active"></div>
            <div id="tab2" class="tab-content"></div>
            <div id="tab3" class="tab-content"></div>
        </section>

        <hr>

        <section id="cronograma">
            <h2>ğŸ“… Cronograma de FÃ©rias</h2>
            <div id="cronogramaFilters"></div>
            <div id="cronogramaTable"></div>
            <div id="cronogramaInfo"></div>
        </section>

        <hr>

        <section id="exceptions">
            <h2>âš ï¸ RelatÃ³rio de ExceÃ§Ãµes</h2>
            <div id="exceptionsTable"></div>
            <div id="exceptionsMotives"></div>
        </section>

        <hr>

        <section id="pending-employees">
            <h2>ğŸ” Colaboradores Sem Agendamento</h2>
            <div id="pendingEmployeesTable"></div>
        </section>

        <hr>

        <section id="export-cronograma">
            <h2>ğŸ’¾ Exportar Cronograma</h2>
            <button id="exportButton">ğŸ“¥ BAIXAR CRONOGRAMA DE FÃ‰RIAS (Excel)</button>
        </section>

        <hr>

        <section id="features">
            <h2>âœ¨ Novidades e Funcionalidades</h2>
            <div class="feature-columns">
                <div>
                    <h4>ğŸ¢ Processamento de Centro de Custo:</h4>
                    <ul>
                        <li>Extrai cÃ³digo e descriÃ§Ã£o</li>
                        <li>Extrai categoria principal para agrupamento</li>
                        <li>MantÃ©m rastreabilidade completa</li>
                        <li>AnÃ¡lises visuais por centro de custo</li>
                    </ul>
                </div>
                <div>
                    <h4>ğŸ‘” DistribuiÃ§Ã£o por Cargo:</h4>
                    <ul>
                        <li>Evita ausÃªncia simultÃ¢nea de gestores</li>
                        <li>Intervalos maiores entre cargos crÃ­ticos</li>
                        <li>Alertas automÃ¡ticos para situaÃ§Ãµes especiais</li>
                        <li>RelatÃ³rios hierÃ¡rquicos detalhados</li>
                    </ul>
                </div>
                <div>
                    <h4>ğŸš€ DistribuiÃ§Ã£o Completa:</h4>
                    <ul>
                        <li>Garante processamento de 100% da planilha</li>
                        <li>MÃºltiplas tentativas automÃ¡ticas</li>
                        <li>GrÃ¡fico Real Ã— Limite</li>
                        <li>RelatÃ³rio de conformidade</li>
                    </ul>
                </div>
            </div>
        </section>
    </main>

    <script src="https://cdn.plot.ly/plotly-latest.min.js"></script>
    <script src="script/script.js"></script>
</body>
</html>


